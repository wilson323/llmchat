#!/usr/bin/env sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸš€ Running pre-push checks..."

# è¿è¡Œç±»å‹æ£€æŸ¥
echo "ğŸ“ Running type checks..."
pnpm run type-check
if [ $? -ne 0 ]; then
  echo "âŒ Type check failed!"
  exit 1
fi

# è¿è¡Œ lint æ£€æŸ¥
echo "ğŸ” Running lint checks..."
pnpm run lint
if [ $? -ne 0 ]; then
  echo "âŒ Lint check failed!"
  echo "ğŸ’¡ Try running 'pnpm run lint:fix' to fix some issues automatically"
  exit 1
fi

# è¿è¡Œæµ‹è¯•
echo "ğŸ§ª Running tests..."
pnpm test
if [ $? -ne 0 ]; then
  echo "âŒ Tests failed!"
  exit 1
fi

# æ„å»ºæ£€æŸ¥
echo "ğŸ—ï¸  Running build check..."
pnpm run build
if [ $? -ne 0 ]; then
  echo "âŒ Build failed!"
  exit 1
fi

echo "âœ… All pre-push checks passed! Safe to push."