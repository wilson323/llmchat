#!/usr/bin/env sh
. "$(dirname "$0")/_/husky.sh"

echo "🚀 Running pre-push checks..."

# 运行类型检查
echo "📝 Running type checks..."
pnpm run type-check
if [ $? -ne 0 ]; then
  echo "❌ Type check failed!"
  exit 1
fi

# 运行 lint 检查
echo "🔍 Running lint checks..."
pnpm run lint
if [ $? -ne 0 ]; then
  echo "❌ Lint check failed!"
  echo "💡 Try running 'pnpm run lint:fix' to fix some issues automatically"
  exit 1
fi

# 运行测试
echo "🧪 Running tests..."
pnpm test
if [ $? -ne 0 ]; then
  echo "❌ Tests failed!"
  exit 1
fi

# 构建检查
echo "🏗️  Running build check..."
pnpm run build
if [ $? -ne 0 ]; then
  echo "❌ Build failed!"
  exit 1
fi

echo "✅ All pre-push checks passed! Safe to push."