# LLMChat 文档治理规范

**版本**: 1.0.0  
**创建日期**: 2025-01-16  
**状态**: 生效

---

## 文档体系结构

### 文档职责边界

| 文档 | 职责 | 禁止内容 |
|------|------|---------|
| **constitution.md** | 核心原则、质量标准、治理规则 | 技术实现细节、任务清单 |
| **requirements.md** | 功能需求、非功能需求、用户故事 | 技术实现细节、任务分解 |
| **design.md** | 架构设计、模块设计、接口规范 | 需求描述、任务清单 |
| **tasks.md** | 任务分解、依赖关系、时间估算 | 需求描述、技术实现细节 |
| **technical-details.md** | 技术规范、配置标准、代码示例 | 需求、任务 |
| **terminology.md** | 术语定义、命名规范 | 需求、任务、技术细节 |
| **api-error-codes.md** | 错误代码、错误处理规范 | 其他内容 |

---

## 单一真实来源原则

### 技术细节集中管理

** 禁止**：在多个文档中重复相同的技术细节

**示例（错误做法）**:
```
requirements.md: JWT过期时间1小时
design.md: JWT配置：过期1小时
tasks.md T009: JWT过期时间设置为1小时
```

** 正确做法**：
```
technical-details.md: 
  ## 1.1 JWT配置
  过期时间: 1小时

requirements.md:
  JWT认证系统 [详见技术规范](technical-details.md#11-jwt配置)

tasks.md T009:
  实现JWT服务 [配置参考](../technical-details.md#11-jwt配置)
```

---

### 术语统一管理

** 禁止**：在不同文档使用不同术语表示同一概念

**示例（错误做法）**:
```
requirements.md: Agent智能体
design.md: AI代理
tasks.md: 智能助手
```

** 正确做法**：
```
terminology.md:
  Agent = 智能体 (代码用Agent，文档用智能体)

所有文档: 统一使用术语表定义
```

---

## 文档同步机制

### 变更影响分析

**变更requirements.md时必须检查**:
- [ ] design.md 中的架构是否需要调整
- [ ] tasks.md 中的任务是否需要增减
- [ ] technical-details.md 中的规范是否需要更新

**变更design.md时必须检查**:
- [ ] requirements.md 中的需求是否被满足
- [ ] tasks.md 中的任务是否需要调整
- [ ] technical-details.md 中是否有新的技术决策

**变更tasks.md时必须检查**:
- [ ] 是否所有需求都有任务覆盖
- [ ] 任务依赖关系是否正确
- [ ] 时间估算是否合理

---

## 文档版本控制

### 版本号规范

遵循语义化版本：`MAJOR.MINOR.PATCH`

- **MAJOR**: 文档结构重大变更、废弃旧规范
- **MINOR**: 新增章节、新增规范
- **PATCH**: 修正错误、澄清说明

### 变更历史记录

每个文档必须包含变更历史表：

```markdown
## 版本历史

| 版本 | 日期 | 变更 | 作者 |
|------|------|------|------|
| 1.0.1 | 2025-01-20 | 修正JWT配置说明 | @developer |
| 1.0.0 | 2025-01-16 | 初始版本 | @team |
```

---

## 质量检查清单

### 提交文档前必须检查

**内容质量**:
- [ ] 无错别字和语法错误
- [ ] 所有链接可访问
- [ ] 所有代码示例可执行
- [ ] 术语使用符合terminology.md

**结构质量**:
- [ ] 章节编号正确
- [ ] 目录索引完整
- [ ] 版本号已更新
- [ ] 变更历史已记录

**一致性检查**:
- [ ] 无重复内容
- [ ] 无冲突描述
- [ ] 引用格式正确
- [ ] 与其他文档一致

---

## 自动化验证工具

### 使用方法

```bash
# 检查文档一致性
node scripts/validate-docs.js

# 检查覆盖率
node scripts/check-coverage.js

# 检查模糊术语
node scripts/detect-ambiguity.js

# 检查引用完整性
node scripts/verify-references.js
```

### 验证工具清单

| 工具 | 功能 | 输出 |
|------|------|------|
| validate-docs.js | 跨文档一致性验证 | 不一致报告 |
| check-coverage.js | 需求-任务覆盖率分析 | 覆盖率报告 |
| detect-ambiguity.js | 模糊术语检测 | 模糊术语列表 |
| verify-references.js | 引用完整性检查 | 死链接列表 |

---

## 文档审查流程

### PR中的文档变更

**审查重点**:
1. 变更是否符合文档职责边界
2. 是否引入重复内容
3. 是否影响其他文档
4. 术语使用是否规范
5. 技术细节是否应该在technical-details.md

**审查清单**:
- [ ] 运行自动化验证工具
- [ ] 人工检查文档质量
- [ ] 验证跨文档一致性
- [ ] 确认变更历史已更新

---

## 违规处理

### 违规类型

**严重违规**（阻止合并）:
- 重复技术规范（应在technical-details.md）
- 使用非标准术语（未在terminology.md定义）
- 死链接或引用不存在的文档

**一般违规**（警告但可合并）:
- 格式不规范
- 版本号未更新
- 变更历史缺失

---

## 文档维护责任

### 责任分工

| 文档 | 主要维护者 | 审查者 |
|------|-----------|--------|
| constitution.md | 架构师 | 全体开发者 |
| requirements.md | 产品经理 | 架构师、开发Lead |
| design.md | 架构师 | 开发Lead |
| tasks.md | 开发Lead | 架构师 |
| technical-details.md | 架构师 | 全体开发者 |
| terminology.md | 架构师 | 全体开发者 |
| api-error-codes.md | 后端Lead | 前端Lead |

### 定期审查

**频率**: 每Sprint结束（2周）

**审查内容**:
- 文档是否与代码实现一致
- 是否有新的技术细节需要记录
- 是否有过时内容需要移除
- 术语表是否需要更新

---

## 版本历史

| 版本 | 日期 | 变更 |
|------|------|------|
| 1.0.0 | 2025-01-16 | 初始版本 |

---

**维护者**: LLMChat 开发团队
