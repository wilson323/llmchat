---
description: TypeScriptå¯¼å…¥å¯¼å‡ºæ¨¡å¼ç»Ÿä¸€è§„èŒƒ - æ¶ˆé™¤ç±»å‹é”™è¯¯æ ¹æœ¬åŸå› 
globs: frontend/src/**/*.{ts,tsx}
alwaysApply: true
---

# TypeScriptå¯¼å…¥å¯¼å‡ºæ¨¡å¼ç»Ÿä¸€è§„èŒƒ

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

### åŸåˆ™1: ç±»å‹/å€¼ä¸¥æ ¼åˆ†ç¦»
- **Interface/Type Alias** â†’ ä½¿ç”¨ `export type {}`
- **Class/Const/Function** â†’ ä½¿ç”¨ `export {}`
- **ç¦æ­¢æ··ç”¨**ï¼šé¿å…TS1361ã€TS2484é”™è¯¯

### åŸåˆ™2: Default Exportç”¨äºä¸»ç»„ä»¶
- **Reactç»„ä»¶** â†’ ä½¿ç”¨ `export default`
- **å·¥å…·å‡½æ•°/å¸¸é‡** â†’ ä½¿ç”¨ `export {}`
- **ç±»å‹å®šä¹‰** â†’ ä½¿ç”¨ `export type {}`

### åŸåˆ™3: å•ä¸€çœŸå®æ¥æº
- **UIç»„ä»¶ç±»å‹** â†’ `ui.types.ts` å”¯ä¸€æƒå¨å®šä¹‰
- **ä¸šåŠ¡ç±»å‹** â†’ `types/index.ts` æˆ–ç‰¹å®šæ¨¡å—
- **ç¦æ­¢é‡å¤å®šä¹‰**åŒä¸€ç±»å‹

## ğŸ“¦ ç»„ä»¶å¯¼å‡ºæ¨¡å¼

### æ¨¡å¼1: ç®€å•ç»„ä»¶ï¼ˆButton, Inputç­‰ï¼‰

```typescript
// âœ… Button.tsx - æ­£ç¡®æ¨¡å¼
import type { ButtonProps } from './ui.types';

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  (props, ref) => {
    return <button ref={ref} {...props} />;
  }
);
Button.displayName = 'Button';

// åªå¯¼å‡ºä¸»ç»„ä»¶
export default Button;
```

**ä½¿ç”¨æ–¹å¼**:
```typescript
import Button from '@/components/ui/Button';
// æˆ–
import { Button } from '@/components/ui'; // é€šè¿‡index.tsè½¬å‘
```

### æ¨¡å¼2: å¤åˆç»„ä»¶ï¼ˆCard, Select, Tabsç­‰ï¼‰

```typescript
// âœ… Card.tsx - æ­£ç¡®æ¨¡å¼
import type { CardProps, CardHeaderProps, CardContentProps } from './ui.types';
import { createSubComponent, attachSubComponents } from './ui.types';

// å­ç»„ä»¶å®ç°
const CardHeaderImpl = React.forwardRef<HTMLDivElement, CardHeaderProps>(...);
CardHeaderImpl.displayName = 'Card.Header';

const CardContentImpl = React.forwardRef<HTMLDivElement, CardContentProps>(...);
CardContentImpl.displayName = 'Card.Content';

// ä¸»ç»„ä»¶å®ç°
const CardImpl = React.forwardRef<HTMLDivElement, CardProps>(...);
CardImpl.displayName = 'Card';

// åˆ›å»ºå­ç»„ä»¶ï¼ˆä½¿ç”¨å·¥å‚å‡½æ•°ï¼‰
const CardHeader = createSubComponent('Card.Header', CardHeaderImpl);
const CardContent = createSubComponent('Card.Content', CardContentImpl);

// é™„åŠ å­ç»„ä»¶åˆ°ä¸»ç»„ä»¶
const Card = attachSubComponents(CardImpl, {
  Header: CardHeader,
  Content: CardContent,
});

// å¯¼å‡ºä¸»ç»„ä»¶ï¼ˆdefaultï¼‰å’Œå­ç»„ä»¶ï¼ˆnamedï¼‰
export default Card;
export { CardHeader, CardContent };
```

**ä½¿ç”¨æ–¹å¼**:
```typescript
// æ–¹å¼1: é»˜è®¤å¯¼å…¥ï¼ˆæ¨èï¼‰
import Card from '@/components/ui/Card';
<Card>
  <Card.Header>...</Card.Header>
  <Card.Content>...</Card.Content>
</Card>

// æ–¹å¼2: ç‹¬ç«‹å¯¼å…¥å­ç»„ä»¶ï¼ˆç‰¹æ®Šåœºæ™¯ï¼‰
import Card, { CardHeader, CardContent } from '@/components/ui/Card';
```

**âŒ é”™è¯¯æ¨¡å¼ - å¯¼è‡´TS2614é”™è¯¯**:
```typescript
// âŒ é”™è¯¯ï¼šå­ç»„ä»¶ä½¿ç”¨named export
export { SelectTrigger, SelectContent };
// å¯¼è‡´ä½¿ç”¨æ—¶æŠ¥é”™ï¼šModule has no exported member 'SelectTrigger'

// âœ… æ­£ç¡®ï¼šå­ç»„ä»¶é€šè¿‡defaultå¯¼å‡ºçš„ä¸»ç»„ä»¶è®¿é—®
import Select from '@/components/ui/Select';
<Select.Trigger>...</Select.Trigger>
```

### æ¨¡å¼3: æ³›å‹ç»„ä»¶ï¼ˆVirtualScrollç­‰ï¼‰

```typescript
// âœ… VirtualScroll.tsx - æ­£ç¡®æ¨¡å¼
import type { VirtualScrollProps } from './ui.types';

// å†…éƒ¨å®ç°å‡½æ•°ï¼ˆéæ³›å‹ï¼‰
function VirtualScrollImpl(
  props: VirtualScrollProps,
  ref: React.Ref<HTMLDivElement>
) {
  // å®ç°...
}

// forwardRefåŒ…è£…ï¼ˆéæ³›å‹ï¼‰
const VirtualScroll = React.forwardRef(VirtualScrollImpl);
VirtualScroll.displayName = 'VirtualScroll';

// å¯¼å‡ºï¼ˆå‘½åå¯¼å‡ºï¼Œå› ä¸ºindex.tsä½¿ç”¨named exportï¼‰
export { VirtualScroll };

// âŒ é¿å…ï¼šæ³›å‹forwardRefä¼šå¯¼è‡´ç±»å‹æ¨å¯¼é—®é¢˜
export const VirtualScroll = forwardRef<HTMLDivElement, VirtualScrollProps>(
  function VirtualScroll<T>({ ... }) { } // é”™è¯¯ï¼forwardRefä¸æ”¯æŒæ³›å‹å‡½æ•°
);
```

## ğŸ“ ç±»å‹å®šä¹‰ä½ç½®è§„èŒƒ

### è§„åˆ™1: UIç»„ä»¶ç±»å‹ â†’ ui.types.ts

```typescript
// âœ… frontend/src/components/ui/ui.types.ts
export interface ButtonProps { ... }
export interface CardProps { ... }
export interface SelectProps { ... }

// âŒ ç¦æ­¢ï¼šåœ¨ç»„ä»¶æ–‡ä»¶ä¸­å®šä¹‰æ¥å£
// Button.tsx ä¸­å®šä¹‰ interface ButtonProps - é”™è¯¯ï¼
```

### è§„åˆ™2: ä¸šåŠ¡ç±»å‹ â†’ servicesæˆ–types

```typescript
// âœ… ä¸šåŠ¡æ•°æ®ç±»å‹å®šä¹‰åœ¨servicesä¸­
// frontend/src/services/analyticsApi.ts
export interface ConversationSeriesDataset { ... }

// âœ… types/index.ts è½¬å‘å¯¼å‡º
export type { ConversationSeriesDataset } from '@/services/analyticsApi';

// âŒ ç¦æ­¢ï¼šåœ¨types/index.tsä¸­é‡å¤å®šä¹‰
interface ConversationSeriesDataset { ... } // é”™è¯¯ï¼
```

### è§„åˆ™3: å…±äº«ç±»å‹ â†’ types/index.ts

```typescript
// âœ… frontend/src/types/index.ts - ä½œä¸ºè½¬å‘å±‚
export type { ButtonProps, CardProps } from '@/components/ui';
export type { ConversationSeriesDataset } from '@/services/analyticsApi';
export type { AgentItem } from './admin';

// âŒ ç¦æ­¢ï¼šé‡å¤å®šä¹‰å·²å­˜åœ¨çš„ç±»å‹
interface AgentItem { ... } // é”™è¯¯ï¼admin.tså·²å®šä¹‰
```

## ğŸ”§ index.tsè½¬å‘è§„èŒƒ

### UIç»„ä»¶ index.ts æ¨¡å¼

```typescript
// âœ… frontend/src/components/ui/index.ts

// ç±»å‹å¯¼å‡ºï¼ˆä½¿ç”¨export typeï¼‰
export type {
  ButtonProps,
  CardProps,
  SelectProps,
} from './ui.types';

// ç»„ä»¶å¯¼å‡ºï¼ˆdefault exportè½¬ä¸ºnamedï¼‰
export { default as Button } from './Button';
export { default as Card } from './Card';
export { default as Select } from './Select';

// ç‰¹æ®Šï¼šVirtualScrollä½¿ç”¨named export
export { VirtualScroll } from './VirtualScroll';
```

### types/index.ts æ¨¡å¼

```typescript
// âœ… frontend/src/types/index.ts - ä½œä¸ºç±»å‹èšåˆå’Œè½¬å‘å±‚

// ä»å…¶ä»–æ¨¡å—è½¬å‘ç±»å‹ï¼ˆä½¿ç”¨export typeï¼‰
export type { ConversationSeriesDataset, AgentComparisonDataset } from '@/services/analyticsApi';
export type { AgentItem } from './admin';
export type { ButtonProps, CardProps } from '@/components/ui';

// å®šä¹‰æ–°çš„ç±»å‹ï¼ˆä»…åœ¨æ²¡æœ‰æ›´å¥½å½’å±æ—¶ï¼‰
export interface ConversationAnalyticsFilters {
  startDate: string;
  endDate: string;
  agentId: string;
}
```

## ğŸš« å¸¸è§é”™è¯¯æ¨¡å¼ä¸ä¿®å¤

### é”™è¯¯1: TS2614 - Module has no exported member

**åŸå› **: å°è¯•ä½¿ç”¨named importå¯¼å…¥åªæœ‰default exportçš„æ¨¡å—

```typescript
// âŒ é”™è¯¯
import { Select, SelectTrigger } from '@/components/ui/Select';
// Error: Module has no exported member 'Select'

// âœ… ä¿®å¤æ–¹å¼1: ä½¿ç”¨default import
import Select from '@/components/ui/Select';
<Select.Trigger>...</Select.Trigger>

// âœ… ä¿®å¤æ–¹å¼2: é€šè¿‡index.tsè½¬å‘
import { Select } from '@/components/ui';
<Select.Trigger>...</Select.Trigger>
```

### é”™è¯¯2: TS1361 - Cannot be used as a value

**åŸå› **: Interface/Typeè¢«å½“ä½œå€¼å¯¼å‡º

```typescript
// âŒ é”™è¯¯
export { ButtonProps } from './ui.types';
// Error: 'ButtonProps' cannot be used as a value

// âœ… ä¿®å¤
export type { ButtonProps } from './ui.types';
```

### é”™è¯¯3: TS2484 - Re-exporting conflicts

**åŸå› **: åŒä¸€ä¸ªåç§°åœ¨å¤šå¤„å¯¼å‡º

```typescript
// âŒ é”™è¯¯
// ui.types.ts
export function createSubComponent() { ... }

// types.unified.ts
export function createSubComponent() { ... } // é‡å¤å®šä¹‰ï¼

// âœ… ä¿®å¤ï¼šåˆ é™¤é‡å¤å®šä¹‰ï¼Œæˆ–ä½¿ç”¨re-export
export { createSubComponent } from './ui.types';
```

### é”™è¯¯4: æ³›å‹forwardRefç±»å‹é—®é¢˜

```typescript
// âŒ é”™è¯¯ï¼šforwardRefä¸æ”¯æŒæ³›å‹å‡½æ•°ç»„ä»¶
export const VirtualScroll = forwardRef<HTMLDivElement, VirtualScrollProps>(
  function VirtualScroll<T>({ items }: { items: T[] }) { ... }
  // Error: ç±»å‹æ¨å¯¼å¤±è´¥
);

// âœ… ä¿®å¤ï¼šå°†æ³›å‹ç§»åˆ°Propsç±»å‹ä¸­
interface VirtualScrollProps<T = unknown> {
  items: T[];
  renderItem: (item: T) => React.ReactNode;
}

function VirtualScrollImpl(
  props: VirtualScrollProps,
  ref: React.Ref<HTMLDivElement>
) { ... }

export const VirtualScroll = React.forwardRef(VirtualScrollImpl);
```

## ğŸ“‹ æ£€æŸ¥æ¸…å•

### å¼€å‘å‰æ£€æŸ¥
- [ ] ç±»å‹æ˜¯å¦å·²åœ¨ui.types.tsä¸­å®šä¹‰ï¼Ÿï¼ˆé¿å…é‡å¤ï¼‰
- [ ] æ˜¯å¦éœ€è¦å¤åˆç»„ä»¶ç»“æ„ï¼Ÿï¼ˆéœ€è¦åˆ™ä½¿ç”¨attachSubComponentsï¼‰
- [ ] ç»„ä»¶æ˜¯å¦éœ€è¦refï¼Ÿï¼ˆéœ€è¦åˆ™ä½¿ç”¨forwardRefï¼‰
- [ ] æ˜¯å¦æ˜¯æ³›å‹ç»„ä»¶ï¼Ÿï¼ˆé¿å…æ³›å‹forwardRefï¼‰

### å¯¼å‡ºå‰æ£€æŸ¥
- [ ] Interface/Typeä½¿ç”¨`export type {}`ï¼Ÿ
- [ ] Class/Functionä½¿ç”¨`export {}`ï¼Ÿ
- [ ] å¤åˆç»„ä»¶å­ç»„ä»¶æ˜¯å¦å·²é™„åŠ ï¼Ÿ
- [ ] displayNameæ˜¯å¦å·²è®¾ç½®ï¼Ÿ

### ä½¿ç”¨æ—¶æ£€æŸ¥
- [ ] ç»„ä»¶ä½¿ç”¨default importï¼Ÿ
- [ ] å­ç»„ä»¶é€šè¿‡ä¸»ç»„ä»¶è®¿é—®ï¼ˆCard.Headerï¼‰ï¼Ÿ
- [ ] ç±»å‹ä½¿ç”¨type importï¼Ÿ

## ğŸ¯ æœ€ä½³å®è·µæ€»ç»“

1. **ç±»å‹å®šä¹‰é›†ä¸­åŒ–** - ui.types.tså”¯ä¸€æƒå¨
2. **å¯¼å‡ºæ¨¡å¼ç»Ÿä¸€åŒ–** - defaultç”¨äºç»„ä»¶ï¼Œnamedç”¨äºå·¥å…·
3. **ç±»å‹/å€¼ä¸¥æ ¼åˆ†ç¦»** - export type vs export
4. **å¤åˆç»„ä»¶æ ‡å‡†åŒ–** - ä½¿ç”¨attachSubComponents
5. **æ³›å‹è°¨æ…ä½¿ç”¨** - é¿å…æ³›å‹forwardRef

## å‚è€ƒæ–‡ä»¶
- ç±»å‹å®šä¹‰: [ui.types.ts](mdc:frontend/src/components/ui/ui.types.ts)
- æˆåŠŸæ¡ˆä¾‹: [Card.tsx](mdc:frontend/src/components/ui/Card.tsx)
- æ¶æ„æ ‡å‡†: [TYPESCRIPT_ARCHITECTURE_STANDARDS.md](mdc:frontend/TYPESCRIPT_ARCHITECTURE_STANDARDS.md)
