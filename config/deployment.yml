# LLMChat éƒ¨ç½²é…ç½®æ–‡ä»¶
# ç”¨é€”: å®šä¹‰ä¸åŒç¯å¢ƒçš„éƒ¨ç½²å‚æ•°å’Œç­–ç•¥

# ========================================
# ğŸ—ï¸ é€šç”¨é…ç½®
# ========================================
project:
  name: "llmchat"
  description: "LLMChat æ™ºèƒ½ä½“åˆ‡æ¢èŠå¤©åº”ç”¨"
  version: "1.0.0"
  maintainer: "DevOps Team"

# ========================================
# ğŸŒ ç¯å¢ƒé…ç½®
# ========================================
environments:
  # å¼€å‘ç¯å¢ƒ
  development:
    enabled: true
    description: "å¼€å‘ç¯å¢ƒ - ç”¨äºæ—¥å¸¸å¼€å‘å’Œæµ‹è¯•"

    # æ„å»ºé…ç½®
    build:
      node_env: "development"
      source_maps: true
      minify: false
      optimize: false

    # éƒ¨ç½²é…ç½®
    deployment:
      host: "localhost"
      port: 3001
      url: "http://localhost:3001"
      ssl: false
      replicas: 1

    # èµ„æºé™åˆ¶
    resources:
      cpu_limit: "1"
      memory_limit: "1Gi"
      cpu_request: "0.5"
      memory_request: "512Mi"

    # å¥åº·æ£€æŸ¥
    health_check:
      enabled: true
      path: "/api/health"
      interval: 30
      timeout: 10
      retries: 3

    # æ•°æ®åº“é…ç½®
    database:
      host: "localhost"
      port: 5432
      name: "llmchat_dev"
      ssl_mode: "disable"

    # Redisé…ç½®
    redis:
      host: "localhost"
      port: 6379
      db: 0
      password: ""

    # æ—¥å¿—é…ç½®
    logging:
      level: "debug"
      format: "dev"
      console: true

    # è´¨é‡é—¨ç¦
    quality_gates:
      required_score: 70
      skip_tests: false
      skip_security: false

  # æµ‹è¯•ç¯å¢ƒ
  staging:
    enabled: true
    description: "æµ‹è¯•ç¯å¢ƒ - ç”¨äºQAæµ‹è¯•å’Œé¢„ç”Ÿäº§éªŒè¯"

    # æ„å»ºé…ç½®
    build:
      node_env: "production"
      source_maps: false
      minify: true
      optimize: true

    # éƒ¨ç½²é…ç½®
    deployment:
      host: "staging.llmchat.example.com"
      port: 443
      url: "https://staging.llmchat.example.com"
      ssl: true
      replicas: 2

    # èµ„æºé™åˆ¶
    resources:
      cpu_limit: "2"
      memory_limit: "2Gi"
      cpu_request: "1"
      memory_request: "1Gi"

    # å¥åº·æ£€æŸ¥
    health_check:
      enabled: true
      path: "/api/health"
      interval: 30
      timeout: 15
      retries: 5

    # æ•°æ®åº“é…ç½®
    database:
      host: "staging-db.example.com"
      port: 5432
      name: "llmchat_staging"
      ssl_mode: "require"

    # Redisé…ç½®
    redis:
      host: "staging-redis.example.com"
      port: 6379
      db: 0
      password: "${REDIS_PASSWORD}"

    # æ—¥å¿—é…ç½®
    logging:
      level: "info"
      format: "json"
      console: false

    # ç›‘æ§é…ç½®
    monitoring:
      enabled: true
      metrics_path: "/metrics"
      tracing: true

    # è´¨é‡é—¨ç¦
    quality_gates:
      required_score: 80
      skip_tests: false
      skip_security: false

  # ç”Ÿäº§ç¯å¢ƒ
  production:
    enabled: true
    description: "ç”Ÿäº§ç¯å¢ƒ - é¢å‘æœ€ç»ˆç”¨æˆ·"

    # æ„å»ºé…ç½®
    build:
      node_env: "production"
      source_maps: false
      minify: true
      optimize: true

    # éƒ¨ç½²é…ç½®
    deployment:
      host: "llmchat.example.com"
      port: 443
      url: "https://llmchat.example.com"
      ssl: true
      replicas: 3

    # èµ„æºé™åˆ¶
    resources:
      cpu_limit: "4"
      memory_limit: "4Gi"
      cpu_request: "2"
      memory_request: "2Gi"

    # å¥åº·æ£€æŸ¥
    health_check:
      enabled: true
      path: "/api/health"
      interval: 15
      timeout: 20
      retries: 10
      liveness_probe:
        path: "/api/health/live"
        initial_delay: 60
      readiness_probe:
        path: "/api/health/ready"
        initial_delay: 30

    # æ•°æ®åº“é…ç½®
    database:
      host: "prod-db-cluster.example.com"
      port: 5432
      name: "llmchat_production"
      ssl_mode: "require"
      pool_size: 20
      max_overflow: 30

    # Redisé…ç½®
    redis:
      host: "prod-redis-cluster.example.com"
      port: 6379
      db: 0
      password: "${REDIS_PASSWORD}"
      cluster_mode: true

    # æ—¥å¿—é…ç½®
    logging:
      level: "warn"
      format: "json"
      console: false
      file: true
      rotation: true

    # ç›‘æ§é…ç½®
    monitoring:
      enabled: true
      metrics_path: "/metrics"
      tracing: true
      profiling: true
      alerts: true

    # å®‰å…¨é…ç½®
    security:
      rate_limiting: true
      cors_strict: true
      helmet: true
      csrf_protection: true

    # å¤‡ä»½é…ç½®
    backup:
      enabled: true
      schedule: "0 2 * * *"  # æ¯å¤©å‡Œæ™¨2ç‚¹
      retention_days: 30

    # è´¨é‡é—¨ç¦
    quality_gates:
      required_score: 90
      skip_tests: false
      skip_security: false

# ========================================
# ğŸ³ Docker é…ç½®
# ========================================
docker:
  registry: "registry.example.com"
  namespace: "llmchat"

  # é•œåƒé…ç½®
  image:
    base_image: "node:20-alpine"
    working_dir: "/app"
    user: "nextjs"
    user_id: 1001
    group_id: 1001

  # æ„å»ºå‚æ•°
  build_args:
    NODE_ENV: "production"
    VERSION: "${VERSION}"
    COMMIT_SHA: "${COMMIT_SHA}"
    BUILD_DATE: "${BUILD_DATE}"

  # å®‰å…¨é…ç½®
  security:
    run_as_non_root: true
    read_only_filesystem: false
    no_new_privileges: true

  # å¥åº·æ£€æŸ¥
  healthcheck:
    test: ["CMD", "curl", "-f", "http://localhost:3001/api/health"]
    interval: 30
    timeout: 10
    retries: 3
    start_period: 40

# ========================================
# â˜¸ï¸ Kubernetes é…ç½® (å¯é€‰)
# ========================================
kubernetes:
  enabled: false

  # å‘½åç©ºé—´
  namespace: "llmchat"

  # æœåŠ¡é…ç½®
  service:
    type: "ClusterIP"
    port: 80
    target_port: 3001

  # Ingressé…ç½®
  ingress:
    enabled: true
    class: "nginx"
    annotations:
      nginx.ingress.kubernetes.io/ssl-redirect: "true"
      nginx.ingress.kubernetes.io/proxy-body-size: "10m"
      cert-manager.io/cluster-issuer: "letsencrypt-prod"

  # HPAé…ç½®
  hpa:
    enabled: true
    min_replicas: 2
    max_replicas: 10
    target_cpu_utilization: 70
    target_memory_utilization: 80

  # PDBé…ç½®
  pdb:
    enabled: true
    min_available: "50%"

# ========================================
# ğŸ”§ å·¥å…·é…ç½®
# ========================================
tools:
  # æ„å»ºå·¥å…·
  build:
    tool: "docker"
    parallel: true
    cache_enabled: true

  # éƒ¨ç½²å·¥å…·
  deploy:
    tool: "docker"
    strategy: "rolling"
    rollback_enabled: true
    backup_enabled: true

  # æµ‹è¯•å·¥å…·
  test:
    unit_test_tool: "jest"
    e2e_test_tool: "playwright"
    coverage_tool: "c8"

  # ç›‘æ§å·¥å…·
  monitoring:
    metrics_tool: "prometheus"
    logging_tool: "elasticsearch"
    tracing_tool: "jaeger"
    alerting_tool: "alertmanager"

# ========================================
# ğŸ“Š é€šçŸ¥é…ç½®
# ========================================
notifications:
  enabled: true

  # Slacké€šçŸ¥
  slack:
    enabled: false
    webhook_url: "${SLACK_WEBHOOK_URL}"
    channel: "#deployments"

  # é‚®ä»¶é€šçŸ¥
  email:
    enabled: false
    smtp_host: "${SMTP_HOST}"
    smtp_port: 587
    username: "${SMTP_USERNAME}"
    password: "${SMTP_PASSWORD}"
    from: "deploy@llmchat.example.com"
    to: ["devops@example.com"]

  # Teamsé€šçŸ¥
  teams:
    enabled: false
    webhook_url: "${TEAMS_WEBHOOK_URL}"

# ========================================
# ğŸ”’ å®‰å…¨é…ç½®
# ========================================
security:
  # ç½‘ç»œç­–ç•¥
  network_policy:
    enabled: true
    ingress_rules:
      - port: 80
        protocol: TCP
        from:
          - namespace: "ingress"
      - port: 443
        protocol: TCP
        from:
          - namespace: "ingress"

  # Podå®‰å…¨ç­–ç•¥
  pod_security_policy:
    enabled: true
    privileged: false
    allow_privilege_escalation: false
    read_only_root_filesystem: true
    run_as_non_root: true
    run_as_user: 1001

  # å¯†é’¥ç®¡ç†
  secrets:
    enabled: true
    provider: "kubernetes"  # æˆ– "vault", "aws"

  # æ‰«æé…ç½®
  scanning:
    container_scanning: true
    image_scanning: true
    dependency_scanning: true

# ========================================
# ğŸ“ˆ æ€§èƒ½é…ç½®
# ========================================
performance:
  # ç¼“å­˜é…ç½®
  cache:
    enabled: true
    ttl: 300
    max_size: 1000

  # è¿æ¥æ± é…ç½®
  connection_pool:
    database:
      min: 5
      max: 20
      acquire_timeout: 30000
      idle_timeout: 30000
    redis:
      min: 10
      max: 100
      acquire_timeout: 10000
      idle_timeout: 300000

  # é™æµé…ç½®
  rate_limiting:
    enabled: true
    window_size: 60
    max_requests: 1000
    block_duration: 60

# ========================================
# ğŸ”§ å¼€å‘é…ç½®
# ========================================
development:
  # çƒ­é‡è½½
  hot_reload: true

  # è°ƒè¯•é…ç½®
  debug:
    enabled: true
    port: 9229

  # æ–‡ä»¶ç›‘å¬
  watch:
    enabled: true
    patterns:
      - "src/**/*.ts"
      - "src/**/*.js"
      - "config/**/*.yml"

  # å¼€å‘å·¥å…·
  tools:
    enabled: true
    profiler: true
    memory_leak_detection: true

# ========================================
# ğŸ§ª æµ‹è¯•é…ç½®
# ========================================
testing:
  # å•å…ƒæµ‹è¯•
  unit_test:
    enabled: true
    coverage_threshold: 80
    timeout: 30000

  # é›†æˆæµ‹è¯•
  integration_test:
    enabled: true
    coverage_threshold: 70
    timeout: 60000

  # E2Eæµ‹è¯•
  e2e_test:
    enabled: true
    timeout: 120000
    browsers:
      - "chromium"
      - "firefox"

  # æ€§èƒ½æµ‹è¯•
  performance_test:
    enabled: false
    tools:
      - "artillery"
      - "lighthouse"
    thresholds:
      response_time_p95: 200
      response_time_p99: 500
      error_rate: 0.1

# ========================================
# ğŸ“‹ åˆè§„é…ç½®
# ========================================
compliance:
  # GDPRåˆè§„
  gdpr:
    enabled: true
    data_retention_days: 365
    anonymization_enabled: true

  # SOC 2åˆè§„
  soc2:
    enabled: false
    audit_logging: true
    access_control: true

  # ISO 27001åˆè§„
  iso27001:
    enabled: false
    risk_assessment: true
    incident_response: true

# ========================================
# ğŸ¯ ç‰¹æ€§å¼€å…³
# ========================================
feature_flags:
  # æ–°åŠŸèƒ½å¼€å…³
  new_features:
    enhanced_ui: false
    advanced_analytics: false
    multi_tenant: false

  # å®éªŒæ€§åŠŸèƒ½
  experimental:
    ai_suggestions: false
    real_time_collaboration: false

  # è°ƒè¯•åŠŸèƒ½
  debug:
    verbose_logging: false
    performance_profiling: false
    request_tracing: false

# ========================================
# ğŸ“Š ç›‘æ§æŒ‡æ ‡é…ç½®
# ========================================
metrics:
  # åº”ç”¨æŒ‡æ ‡
  application:
    enabled: true
    path: "/metrics"
    interval: 15

  # ç³»ç»ŸæŒ‡æ ‡
  system:
    enabled: true
    cpu: true
    memory: true
    disk: true
    network: true

  # ä¸šåŠ¡æŒ‡æ ‡
  business:
    enabled: true
    user_sessions: true
    api_requests: true
    error_rates: true
    response_times: true

# ========================================
# ğŸš¨ å‘Šè­¦è§„åˆ™é…ç½®
# ========================================
alerts:
  # ç³»ç»Ÿå‘Šè­¦
  system:
    high_cpu_usage:
      enabled: true
      threshold: 80
      duration: "5m"

    high_memory_usage:
      enabled: true
      threshold: 85
      duration: "5m"

    disk_space_low:
      enabled: true
      threshold: 90
      duration: "2m"

  # åº”ç”¨å‘Šè­¦
  application:
    high_error_rate:
      enabled: true
      threshold: 5
      duration: "2m"

    high_response_time:
      enabled: true
      threshold: 500
      duration: "5m"

    service_down:
      enabled: true
      threshold: 0
      duration: "1m"

  # ä¸šåŠ¡å‘Šè­¦
  business:
    low_user_activity:
      enabled: false
      threshold: 10
      duration: "10m"